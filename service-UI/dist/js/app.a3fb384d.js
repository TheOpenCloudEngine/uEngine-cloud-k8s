(function(e){function t(t){for(var n,r,u=t[0],i=t[1],c=t[2],p=0,d=[];p<u.length;p++)r=u[p],s[r]&&d.push(s[r][0]),s[r]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);l&&l(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,u=1;u<a.length;u++){var i=a[u];0!==s[i]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},s={app:0},o=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],i=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=i;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"17b6":function(e,t,a){"use strict";var n=a("588e"),s=a.n(n);s.a},"56d7":function(e,t,a){"use strict";a.r(t);var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",{attrs:{id:"nav"}},[a("router-link",{attrs:{to:"/"}},[e._v("DashBoard")])],1),a("router-view")],1)},o=[],r=(a("5c0b"),a("2877")),u={},i=Object(r["a"])(u,s,o,!1,null,null,null);i.options.__file="App.vue";var c=i.exports,l=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("DashBoard")],1)},d=[],f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"DashBoard",staticStyle:{margin:"10px"}},[a("h1",[e._v(" List ")]),a("div",[a("dropdown",{attrs:{options:e.nameSpaceList,selected:e.selectedNamespace,placeholder:"Select an Namespace"},on:{updateOption:e.methodToRunOnSelect}})],1),a("div",{staticClass:"table"},[a("h2",[e._v("Pods")]),a("vuetable",{ref:"pods",attrs:{fields:["kubePodId.namespace","kubePodId.name","statusType","phase","startTime","updateTime","endTime"],data:e.list}})],1),a("div",{staticClass:"table"},[a("h2",[e._v("Jobs")]),a("vuetable",{ref:"jobs",attrs:{fields:["kubePodId.namespace","kubePodId.name","statusType","phase","startTime","updateTime","endTime"],data:e.list2}})],1)])},h=[],m=a("af52"),v=a.n(m),b=a("d869"),S={name:"DashBoard",props:{msg:String},components:{vuetable:v.a,dropdown:b["a"]},data(){return{evtSource:null,nameSpaceList:[{id:0,name:"All"}],selectedNamespace:{},list:[],list2:[]}},beforeDestroy:function(){this.evtSource&&(console.log("closing evtSource beforeDestroy"),this.evtSource.close())},mounted(){this.startSSE(),this.getNameSpace()},watch:{selectedNamespace:function(e){var t=this,a=e.name;"All"==a?(this.$http.get(`${API_HOST}/kube/pod/`).then(e=>{t.list=[],t.list=e.data}),null!=this.evtSource&&(this.evtSource.close(),t.startSSE())):(this.$http.get(`${API_HOST}/kube/pod/`+a).then(e=>{t.list=[],0==t.list.length&&e.data.forEach(function(e){"DELETED"!=e.statusType&&t.list.push(e)})}),null!=this.evtSource&&(this.evtSource.close(),t.startSSE(a)))}},methods:{methodToRunOnSelect(e){this.selectedNamespace=e},getNameSpace:function(){var e=this;this.$http.get(`${API_HOST}/kube/pod/`).then(t=>{0==e.list.length&&t.data.forEach(function(t){"DELETED"!=t.statusType&&e.list.push(t)});var a=1,n=[];e.nameSpaceList.length>0&&e.nameSpaceList.forEach(function(e){n.includes(e.name)||n.push(e.name)}),t.data.forEach(function(t){n.includes(t.kubePodId.namespace)||(n.push(t.kubePodId.namespace),e.nameSpaceList.push({id:a,name:t.kubePodId.namespace}),a++)})})},startSSE:function(e){var t=this;null==e?t.evtSource=new EventSource(`${API_HOST}/kubesse/`):this.evtSource=new EventSource(`${API_HOST}/kubesse/?nameSpace=`+e);t.evtSource.onmessage=function(e){var a=JSON.parse(e.data),n=JSON.parse(a.message),s=[];t.list.forEach(function(e){s.push(e.kubePodId.name)}),t.list.some(function(e,a){if(e.kubePodId.name!=n.kubePodId.name)return s.includes(n.kubePodId.name)||"DELETED"==n.statusType?void 0:(t.list.push(n),void s.push(n.kubePodId.name));"DELETED"==n.statusType?t.list=[...t.list.slice(0,a),...t.list.slice(a+1)]:t.list=[...t.list.slice(0,a),n,...t.list.slice(a+1)]})},t.evtSource.onerror=function(e){t.evtSource&&(console.log("closing evtSource and reconnect"),t.evtSource.close(),setTimeout(function(){null!=t.selectedNamespace.name?t.startSSE(t.selectedNamespace.name):t.startSSE()},3e3))}}}},_=S,E=(a("17b6"),Object(r["a"])(_,f,h,!1,null,"521f69c6",null));E.options.__file="DashBoard.vue";var g=E.exports,T={name:"home",components:{DashBoard:g}},P=T,O=Object(r["a"])(P,p,d,!1,null,null,null);O.options.__file="Home.vue";var y=O.exports;n["a"].use(l["a"]);var w=new l["a"]({routes:[{path:"/",name:"home",component:y}]}),k=a("2f62");n["a"].use(k["a"]);var I=new k["a"].Store({state:{},mutations:{},actions:{}}),D=a("bc3a"),j=a.n(D);n["a"].config.productionTip=!1,n["a"].prototype.$http=j.a,window.API_HOST="https://ac919429a22b611e9884d02be6ea23ef-400105267.ap-northeast-2.elb.amazonaws.com",console.log(Object({NODE_ENV:"production",VUE_APP_API_HOST:"https://ac919429a22b611e9884d02be6ea23ef-400105267.ap-northeast-2.elb.amazonaws.com",BASE_URL:"/"})),new n["a"]({router:w,store:I,render:function(e){return e(c)}}).$mount("#app")},"588e":function(e,t,a){},"5c0b":function(e,t,a){"use strict";var n=a("5e27"),s=a.n(n);s.a},"5e27":function(e,t,a){}});
//# sourceMappingURL=app.a3fb384d.js.map